"use strict";var VimiumInjector;(()=>{let t=VimiumInjector,e={id:"",alive:-1,host:"",version:"",cache:null,clickable:void 0,reload:null,checkIfEnabled:null,$:null,$h:"",$m:null,$r:null,$g:null,getCommandCount:null,callback:null,destroy:null};if(t)for(let n of Object.keys(t))e[n]=t[n];e.alive=-1,e.$g=null,VimiumInjector=e})(),(function(t,e){function n(t,n){let l,u,a=VimiumInjector,m=a&&a.clickable,h=a&&a.callback;if(!t){let e=n&&n.message,i=o.id||location.host||location.protocol;if(u=!!(e&&e.lastIndexOf("not exist")>=0&&o.id),false===t?l=": not in the allow list.":!u&&n?l=e?`:\n\t${e}`:": no backend found.":s>3?(l=e?`:\n\t${e}`:`: retried but failed (${t}).`,u=false):(setTimeout(f,200*s),s++,u=true),!u){l=l||` (${s} retries).`;let t="color:red",e="color:auto";console.log("%cVimium C%c: %cfail%c to inject into %c%s%c %s",t,e,t,e,"color:#0c85e9",i,e,l),h&&a.callback(-1,l)}}a&&"function"==typeof a.destroy&&a.destroy(true);let v=VimiumInjector={id:d,alive:0,host:d,version:t?t.version:"",cache:null,clickable:m,reload:e(c),checkIfEnabled:null,$:null,$h:t?t.h:"",$m(t){VimiumInjector&&VimiumInjector.$r("object"==typeof t?t.t:t)},$r(){},$g:null!=r?""===r||"true"===r.toLowerCase():null,getCommandCount:null,callback:h||null,destroy:null},b=document.documentElement;if(!(t&&b instanceof HTMLHtmlElement))return n;let $=document.contains(i)?i:(document.head||b).lastChild,k=$.nextSibling,g=$.parentElement,p=[];for(let e of t.s){let t=document.createElement("script");t.type="text/javascript",t.async=false,t.src=e,g.insertBefore(t,k),p.push(t)}p.length>0&&(p[p.length-1].onload=function(){this.onload=null;for(let t=p.length;0<=--t;)p[t].remove()}),h&&v.callback(0,"loading")}function l(){removeEventListener("DOMContentLoaded",l),a(()=>{a(()=>{setTimeout(f,0)},{timeout:67})},{timeout:330})}let o=chrome.runtime,i=document.currentScript,c=i.src,u=c.indexOf("://")+3,r=i.dataset.blockFocus,a=requestIdleCallback,s=1,d=c.slice(u,c.indexOf("/",u));d=i.dataset.extensionId||d,VimiumInjector.id=d;let f=()=>{o.sendMessage(d,{handler:99,scripts:true},t=>{let e=o.lastError;return e?n(void 0,e):n(t),e})};"loading"!==document.readyState?l():addEventListener("DOMContentLoaded",l,true)})(0,t=>e=>{function n(){let n=document.documentElement,l=document.head||document.body||n,o=document.createElement("script");l&&(o.type="text/javascript",o.async=false,o.src=t,console.log("%cVimium C%c begins to reload%s.","color:red","color:auto",1===e?" because it has been updated.":""),l.append(o))}let l=VimiumInjector;if(l){let t=l.clickable;"function"==typeof l.destroy&&l.destroy(true),l.clickable=t}e?setTimeout(n,200):n()}),(!document.currentScript||"false"!==(document.currentScript.dataset.vimiumHooks||"").toLowerCase())&&null!==VimiumInjector.clickable&&(function(){VimiumInjector.clickable=VimiumInjector.clickable||new WeakSet;let t=EventTarget,e=t.prototype,n=e.addEventListener;if(true===n.vimiumHooked)return;let l=HTMLAnchorElement,o=Element,i=e.addEventListener=function addEventListener(t,e){if("click"===t&&!(this instanceof l)&&e&&this instanceof o){let t=VimiumInjector;t&&t.clickable&&t.clickable.add(this)}let i=arguments,c=i.length;return 2===c?n.call(this,t,e):3===c?n.call(this,t,e,i[2]):n.apply(this,i)},c=Function.prototype,u=c.toString,r=c.toString=function toString(){return u.apply(this===i?n:this===r?u:this,arguments)};i.vimiumHooked=true,t.vimiumRemoveHooks=()=>{delete t.vimiumRemoveHooks,e.addEventListener===i&&(e.addEventListener=n),c.toString===r&&(c.toString=u)},i.prototype=r.prototype=void 0})();