"use strict";__filename="background/action_icon.js",define(["require","exports","./store","./utils","./settings","./i18n","./browser","./ports"],(e,t,n,l,i,o,a,s)=>{Object.defineProperty(t,"__esModule",{value:true}),t.wn=t.In=t.gn=void 0,l=__importStar(l),i=__importStar(i);let r,u=["icons/enabled.bin","icons/partial.bin","icons/disabled.bin"];t.gn=a.Al.action||a.Al.browserAction;let c=e=>{fetch(u[e]).then(e=>e.arrayBuffer()).then(t=>{let i=new Uint8ClampedArray(t),o=t.byteLength/5,a=0|Math.sqrt(o/4),s=a+a,u=l.ct();u[a]=new ImageData(i.subarray(0,o),a,a),u[s]=new ImageData(i.subarray(o),s,s),n.Re[e]=u;let c=r.get(e);r.delete(e);for(let t=0,l=c.length;t<l;t++)n.Pe.has(c[t])&&n.L(c[t],e,true)})};t.In=()=>{let e=i.Nt("showActionIcon");e!==!!n.Re&&(e?(n.B([null,null,null]),r=new Map,s.Kt(({er:{s:t}})=>{0!==t.Ke&&n.L(t.Xl,e?t.Ke:0)},()=>i.Nt("showActionIcon")===e)):setTimeout(()=>{i.Nt("showActionIcon")||null==n.Re||(n.B(null),r=null)},200))},t.wn=(e,l,i)=>{let o;if(e<0);else if(o=n.Re[l]){let n=t.gn.setIcon,l={tabId:e,imageData:o};i?n(l,a.Fl):n(l)}else r.has(l)?r.get(l).push(e):(setTimeout(c,0,l),r.set(l,[e]))}});