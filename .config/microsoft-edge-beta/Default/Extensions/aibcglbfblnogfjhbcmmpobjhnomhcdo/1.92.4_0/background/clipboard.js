"use strict";__filename="background/clipboard.js",define(["require","exports","./store","./utils","./settings","./exclusions"],(e,t,l,r,n,u)=>{Object.defineProperty(t,"__esModule",{value:true}),t.doesNeedToSed=t.rn=void 0,r=__importStar(r),n=__importStar(n),u=__importStar(u);let o={__proto__:null,atob:8,base64:8,base64decode:8,btoa:9,base64encode:9,decodeforcopy:1,decode:1,decodeuri:1,decodeurl:1,decodemaybeescaped:2,decodecomp:2,encode:10,encodecomp:11,encodeall:12,encodeallcomp:13,unescape:3,upper:4,lower:5,capitalize:16,capitalizeall:17,camel:14,camelcase:14,dash:15,dashed:15,hyphen:15,normalize:6,reverse:7,reversetext:7,break:99,stop:99,return:99},a=null,f=(e,t)=>{let l=[],n=new Map;for(let u of e.split("\n")){u=u.trim();let e=/^([A-Za-z\x80-\ufffd]{1,6})([^\x00- A-Za-z\\\x7f-\uffff])/.exec(u);if(!e)continue;let a=e[2],f=n.get(a);if(!f){let e="\\u"+(a.charCodeAt(0)+65536).toString(16).slice(1);f=new RegExp(`^((?:\\\\${e}|[^${e}])+)${e}(.*)${e}([a-zD]{0,9})((?:,[A-Za-z-]+|,host=[\\w.*-]+)*)$`),n.set(a,f)}let c=e[1],p=f.exec(u.slice(e[0].length));if(!p)continue;let d=p[3],_=d.replace(/[dDr]/g,""),b=[],m=null,x=+d.includes("r");d.includes("d")?b.push(2):d.includes("D")&&b.push(1);for(let e of p[4].split(",")){let t=e.toLowerCase();if(t.startsWith("host="))m=e.slice(5);else if(t.startsWith("match"))x=1;else{let e=o[t.replace(/-/g,"")]||0;e&&b.push(e)}}let g=r.l(p[1],x?_.replace("g",""):_);g&&l.push({un:t||i(c),on:m,an:g,fn:x,sn:b,cn:s(p[2],1)})}return l},s=(e,t)=>e.replace(/\\(x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|[^])|\$0/g,(e,l)=>l?"x"===l[0]||"u"===l[0]?"$"===(l=String.fromCharCode(parseInt(l.slice(1),16)))?l+l:l:"t"===l?"\t":"r"===l?"\r":"n"===l?"\n":t?"0"===l?"$&":l>="1"&&l<="9"?"$"+l:l:l:t?"$&":e),c=(e,t)=>{let l=14===t,r=15===t,n=16===t,u=17===t,o=new RegExp(l||r?"(?:[-_\\t\\r\\n/+\\u2010-\\u2015\\p{Z}]|(\\p{N})|^)(\\p{Ll}|\\p{Lu}+\\p{Ll}?)|[\\t\\r\\n/+]":n||u?"(\\b|_)\\p{Ll}":"",n?"u":"ug"),a=0,f=0,s=(e,t)=>t?e.toLocaleLowerCase():e.toLocaleUpperCase();return e=l||r?e.replace(o,(t,l,n,u)=>{let o="\t\r\n/+".includes(t[0]),c=o||!a++&&e.slice(f,u).toUpperCase()===e.slice(f,u).toLowerCase();return o&&(a=0,f=u+1),n=n?n.length>2&&n.slice(-1).toLowerCase()===n.slice(-1)&&!/^e?s\b/.test(e.substr(u+t.length-1,3))?r?s(n.slice(0,-2),true)+"-"+s(n.slice(-2),true):s(n[0],c)+s(n.slice(1,-2),true)+s(n.slice(-2,-1),false)+n.slice(-1):r?s(n,true):s(n[0],c)+s(n.slice(1),true):"",(o?t[0]:(l||"")+(l||r&&!c?"-":""))+n}):n||u?e.replace(o,e=>s(e,false)):e,r&&(e=e.replace(/\p{Ll}(\p{Lu}+\p{Ll}?)/u,(t,l,r)=>(l=l.length>2&&l.slice(-1).toLowerCase()===l.slice(-1)&&!/^e?s\b/.test(e.substr(r+t.length-1,3))?s(l.slice(0,-2),true)+"-"+s(l.slice(-2),true):s(l,true),t[0]+"-"+l))),e};t.rn=e=>{if(null!=e.$sed)return e.$sed;let t=e.sed,l=e.sedKeys||e.sedKey;return null!=t||l?t&&"object"==typeof t?null!=t.r||t.k?t:null:e.$sed={r:t,k:l}:null};let i=(e,t)=>{if("object"==typeof e)return e.in||e.pn?e:t?t.k=null:null;let l=null,r=0;for(let n=0;n<e.length;n++){let u=e.charCodeAt(n);if(u>127){l||(l=[]),!t&&l.includes(u)||l.push(u);continue}let o=-33&u;r|=o<65||o>90?0:83===o?32772:1<<o-65}let n=r||l?{in:r,pn:l}:null;return t?t.k=n:n},p=(e,t)=>{if(e.in&t.in)return true;let l=t.pn;if(!e.pn||!l)return false;for(let t of e.pn)if(l.includes(t))return true;return false};t.doesNeedToSed=(e,t)=>{if(t&&(false===t.r||t.r&&true!==t.r))return false!==t.r;let l=t&&t.k&&i(t.k,t)||(e?{in:e,pn:null}:null);a||l&&(a=f(n.Nt("clipSub"),null));for(let e of l?a:[])if(p(e.un,l))return true;return false},l.u((e,t,l)=>{let o=l&&"object"==typeof l?l.r:l;if(false===o)return e;let d=a||(a=f(n.Nt("clipSub"),null)),_=l&&"object"==typeof l&&l.k&&i(l.k,l)||(t?{in:t,pn:null}:null);o&&true!==o&&(_||(d=[]),d=f((o+"").replace(/(?!\\) ([A-Za-z\x80-\ufffd]{1,6})(?![\x00- A-Za-z\\\x7f-\uffff])/g,"\n$1"),_||(_={in:1073741824,pn:null})).concat(d));for(let t of _?d:[])if(p(t.un,_)&&(!t.on||("string"==typeof t.on&&(t.on=u.ni(t.on)||-1),-1!==t.on&&u.ri(t.on,e)))){let l=-1;if(t.fn){let r,n=0;if(e.replace(t.an,function(e){let t=arguments;return n=t[t.length-2],l=n+e.length,r=t.length>3?t[1]:"",""}),l>=0){let u=e.replace(t.an,t.cn);e=u.slice(n,u.length-(e.length-l))||r||e.slice(n,l)}}else t.an.test(e)&&(l=t.an.lastIndex=0,e=e.replace(t.an,t.cn));if(l<0)continue;if(!e)break;let n=false;for(let l of t.sn)e=1===l?r.et(e):2===l?r.v(e):3===l?s(e):4===l?e.toLocaleUpperCase():5===l?e.toLocaleLowerCase():10===l?r.k(e):11===l?r.g(e):12===l?encodeURI(e):13===l?encodeURIComponent(e):8===l?r.tt(e,"atob"):9===l?btoa(e):(e=6!==l&&7!==l||false?e:e.normalize(),7===l?Array.from(e).reverse().join(""):14===l||15===l||16===l||17===l?c(e,l):e),n=99===l;if(n)break}return r.bt(),e});let d=()=>{let e=document.createElement("textarea");return e.style.position="absolute",e.style.left="-99px",e.style.width="0",e},_=(e,t,r)=>{"string"!=typeof e&&(e="string"==typeof t&&t.startsWith("json")?JSON.stringify(e,null,t.slice(4)||2):e.join(t!==!!t&&t||"\n")+(e.length>1&&(!t||t===!!t)?"\n":""));let n=(e=e.replace(/\xa0/g," ").replace(/[ \t]+(\r\n?|\n)|\r\n?/g,"\n")).charCodeAt(e.length-1);return 32!==n&&9!==n||((n=e.lastIndexOf("\n")+1)?e=e.slice(0,n)+e.slice(n).trimRight():32!==(n=e.charCodeAt(0))&&9!==n&&(e=e.trimRight())),l.j(e,4,r)},b=(e,t)=>(e&&(e=e.replace(/\xa0/g," "),e=l.j(e,32768,t)),e);l.w((e,t,l)=>{if(e=_(e,t,l)){let t=document,l=d();l.value=e,t.body.appendChild(l),l.select(),t.execCommand("copy"),l.remove(),l.value=""}return e}),l.h(l.e.ol?(e,t)=>{let n=d();n.maxLength=t||102400,document.body.appendChild(n),n.focus(),document.execCommand("paste");let u=n.value.slice(0,t||102400);return n.value="",n.remove(),n.removeAttribute("maxlength"),!t&&u.length>=81920&&("data:"===u.slice(0,5).toLowerCase()||r.lt(u))?l.I(e,20971520):b(u,e)}:()=>null),n.Ct.clipSub=()=>{a=null}});