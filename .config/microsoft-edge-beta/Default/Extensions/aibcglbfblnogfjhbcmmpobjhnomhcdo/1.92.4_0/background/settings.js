"use strict";__filename="background/settings.js",define(["require","exports","./store","./utils","./browser","./normalize_urls","./parse_urls","./ports"],(e,t,o,a,s,n,l,i)=>{Object.defineProperty(t,"__esModule",{value:true}),t.Lt=t.Tt=t.Bt=t.Gt=t.Ft=t.Ct=t.Et=t.Ht=t.Pt=t.Dt=t.Rt=t.Nt=t.Jt=void 0,t.Jt=localStorage;let r=null;t.Nt=(e,a)=>{if(e in o.Te)return o.Te[e];let s=t.Ft[e],n=t.Jt.getItem(e),l=null==n?s:"string"==typeof s?n:false===s||true===s?"true"===n:JSON.parse(n);return a&&(o.Te[e]=l),l},t.Rt=(e,a)=>{if(o.Te[e]=a,!(e in t.Bt)){let s=t.Ft[e];a===s?(t.Jt.removeItem(e),o.V(e,null)):(t.Jt.setItem(e,"string"==typeof s?a:JSON.stringify(a)),o.V(e,a)),e in t.Lt&&t.Et(t.Lt[e],a,o.Ye)}let s;if(s=t.Ct[e])return s(a,e)},t.Dt=(e,o)=>t.Ct[e](void 0!==o?o:t.Nt(e),e),t.Pt=e=>{if(6!==e.N)c(e);else if(null==e.d.length)c(e);else{let t=e.d,o=r;o?t=t.concat(o):a.s(c.bind(null,e)),r=t,e.d=null}};let c=e=>{if(6===e.N&&!e.d){let t=r,a=e.d={};for(let e of t)a[e]=o.Ye[e];r=null}i.Kt(t=>{for(let o of t.Qt)o.postMessage(e)})};t.Ht=e=>{a.n(o.fe.slice(0),t=>(o.fe.includes(t)&&t.postMessage(e),1))},t.Et=(e,t,a)=>{switch(e){case"c":case"n":t=t.toLowerCase().toUpperCase();break;case"i":t=t===!!t?t:t>1||t>0&&!o.Ye.o;break;case"l":t=t===!!t?t?2:0:t;break;case"d":t=t?" D":""}return a?a[e]=t:t},t.Ct={__proto__:null,extAllowList(e){let t=o.ke;if(t.forEach((e,o)=>{false!==e&&t.delete(o)}),e)for(let o=e.split("\n"),a=o.length,s=/^[\da-z_]/i;0<=--a;)(e=o[a].trim())&&s.test(e)&&t.set(e,true)},grabBackFocus(e){o.Ye.g=e},newTabUrl(e){e=/^\/?pages\/[a-z]+.html\b/i.test(e)?s.Al.runtime.getURL(e):s.zl(n.yt(e)),t.Rt("newTabUrl_f",e)},searchEngines(){let e=o.Te.searchEngineMap;e.clear(),"searchKeywords"in o.Te&&t.Rt("searchKeywords",null);let a=l.Ul("~:"+t.Nt("searchUrl")+"\n"+t.Nt("searchEngines"),e);t.Rt("searchEngineRules",a)},searchUrl(e){let a=o.Te,s=a.searchEngineMap;if(e)l.Ul("~:"+e,s);else if(s.clear(),s.set("~",{Nl:"~",A:"",Ot:t.Nt("searchUrl").split(" ",1)[0]}),a.searchEngineRules=[],t.Nt("newTabUrl_f",true))return;t.Dt("newTabUrl")},mapModifier(e){t.Ht({N:47,d:{a:e}})},vomnibarPage(e){let a=t.Jt.getItem("vomnibarPage_f");!a||e?((e=e?s.zl(e):t.Nt("vomnibarPage"))===t.Ft.vomnibarPage?e=o.e.Cl:e.startsWith("front/")?e=s.Al.runtime.getURL(e):(e=n.yt(e),e=(e=n.$t(e)).replace(":version",`${parseFloat(o.e.rl)}`)),t.Rt("vomnibarPage_f",e)):o.Te.vomnibarPage_f=a}},t.Ft={__proto__:null,allBrowserUrls:false,autoDarkMode:true,autoReduceMotion:false,clipSub:"p=^git@([^/:]+):=https://$1/=\np@^https://item\\.m\\.jd\\.com/product/(\\d+)\\.html\\b@https://item.jd.com/$1.html@",exclusionListenHash:true,exclusionOnlyFirstMatch:false,exclusionRules:[{pattern:":https://mail.google.com/",passKeys:""}],extAllowList:"# modified versions of X New Tab and PDF Viewer,\n# NewTab Adapter, and Shortcuts Forwarding Tool\nhdnehngglnbnehkfcidabjckinphnief\nnacjakoppgmdcpemlfnfegmlhipddanj\ncglpcedifkgalfdklahhcchnjepcckfn\nclnalilglegcjmlgenoppklmfppddien",filterLinkHints:false,findModeRawQueryList:"",grabBackFocus:false,hideHud:false,ignoreCapsLock:0,ignoreKeyboardLayout:0,innerCSS:"",keyboard:[560,33],keyMappings:"",linkHintCharacters:"sadjklewcmpgh",linkHintNumbers:"0123456789",localeEncoding:"gbk",mapModifier:0,mouseReachable:true,newTabUrl:"",newTabUrl_f:"",nextPatterns:"\u4e0b\u4e00\u5c01,\u4e0b\u9875,\u4e0b\u4e00\u9875,\u4e0b\u4e00\u7ae0,\u540e\u4e00\u9875,next,more,newer,>,\u203a,\u2192,\xbb,\u226b,>>",omniBlockList:"",previousPatterns:"\u4e0a\u4e00\u5c01,\u4e0a\u9875,\u4e0a\u4e00\u9875,\u4e0a\u4e00\u7ae0,\u524d\u4e00\u9875,prev,previous,back,older,<,\u2039,\u2190,\xab,\u226a,<<",regexFindMode:false,scrollStepSize:100,searchUrl:navigator.language.startsWith("zh")?"https://www.baidu.com/s?ie=utf-8&wd=%s \u767e\u5ea6":"https://www.google.com/search?q=%s Google",searchEngines:navigator.language.startsWith("zh")?"b|ba|baidu|Baidu|\u767e\u5ea6: https://www.baidu.com/s?ie=utf-8&wd=%s \\\n  blank=https://www.baidu.com/ \u767e\u5ea6\nbi: https://cn.bing.com/search?q=$s\nbi|bing|Bing|\u5fc5\u5e94: https://www.bing.com/search?q=%s \\\n  blank=https://cn.bing.com/ \u5fc5\u5e94\ng|go|gg|google|Google|\u8c37\u6b4c: https://www.google.com/search?q=%s\\\n  www.google.com re=/^(?:\\.[a-z]{2,4})?\\/search\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://www.google.com/ Google\nd|ddg|duckduckgo: https://duckduckgo.com/?q=%s DuckDuckGo\nqw|qwant: https://www.qwant.com/?q=%s Qwant\n\nb.m|bm|map|b.map|bmap|\u5730\u56fe|\u767e\u5ea6\u5730\u56fe: \\\n  https://api.map.baidu.com/geocoder?output=html&address=%s&src=vimium-c\\\n  blank=https://map.baidu.com/\ngd|gaode|\u9ad8\u5fb7\u5730\u56fe: https://www.gaode.com/search?query=%s \\\n  blank=https://www.gaode.com\ng.m|gm|g.map|gmap: https://www.google.com/maps?q=%s \\\n  blank=https://www.google.com/maps \u8c37\u6b4c\u5730\u56fe\nbili|bilibili|bz|Bili: https://search.bilibili.com/all?keyword=%s \\\n  blank=https://www.bilibili.com/ \u54d4\u54e9\u54d4\u54e9\ny|yt: https://www.youtube.com/results?search_query=%s \\\n  blank=https://www.youtube.com/ YouTube\n\nw|wiki: https://www.wikipedia.org/w/index.php?search=%s Wikipedia\nb.x|b.xs|bx|bxs|bxueshu: https://xueshu.baidu.com/s?ie=utf-8&wd=%s \\\n  blank=https://xueshu.baidu.com/ \u767e\u5ea6\u5b66\u672f\ngs|g.s|gscholar|g.x|gx|gxs: https://scholar.google.com/scholar?q=$s \\\n  scholar.google.com re=/^(?:\\.[a-z]{2,4})?\\/scholar\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://scholar.google.com/ \u8c37\u6b4c\u5b66\u672f\n\nt|tb|taobao|ali|\u6dd8\u5b9d: https://s.taobao.com/search?ie=utf8&q=%s \\\n  blank=https://www.taobao.com/ \u6dd8\u5b9d\nj|jd|jingdong|\u4eac\u4e1c: https://search.jd.com/Search?enc=utf-8&keyword=%s\\\n  blank=https://jd.com/ \u4eac\u4e1c\naz|amazon: https://www.amazon.com/s/?field-keywords=%s \\\n  blank=https://www.amazon.com/ \u4e9a\u9a6c\u900a\n\nv.m|v\\:math: vimium://math\\ $S re= \u8ba1\u7b97\u5668\ngh|github: https://github.com/search?q=$s \\\n  blank=https://github.com/ GitHub \u4ed3\u5e93\nge|gitee: https://search.gitee.com/?type=repository&q=$s \\\n  blank=https://gitee.com/ Gitee \u4ed3\u5e93\njs\\:|Js: javascript:\\ $S; JavaScript":"bi: https://cn.bing.com/search?q=$s\nbi|bing: https://www.bing.com/search?q=%s \\\n  blank=https://www.bing.com/ Bing\nb|ba|baidu|\u767e\u5ea6: https://www.baidu.com/s?ie=utf-8&wd=%s \\\n  blank=https://www.baidu.com/ \u767e\u5ea6\ng|go|gg|google|Google: https://www.google.com/search?q=%s \\\n  www.google.com re=/^(?:\\.[a-z]{2,4})?\\/search\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://www.google.com/ Google\nd|ddg|duckduckgo: https://duckduckgo.com/?q=%s DuckDuckGo\nqw|qwant: https://www.qwant.com/?q=%s Qwant\n\ng.m|gm|g.map|gmap: https://www.google.com/maps?q=%s \\\n  blank=https://www.google.com/maps Google Maps\nb.m|bm|map|b.map|bmap|\u767e\u5ea6\u5730\u56fe: \\\n  https://api.map.baidu.com/geocoder?output=html&address=%s&src=vimium-c\ny|yt: https://www.youtube.com/results?search_query=%s \\\n  blank=https://www.youtube.com/ YouTube\nw|wiki: https://www.wikipedia.org/w/index.php?search=%s Wikipedia\ng.s|gs|gscholar: https://scholar.google.com/scholar?q=$s \\\n  scholar.google.com re=/^(?:\\.[a-z]{2,4})?\\/scholar\\b.*?[#&?]q=([^#&]*)/i\\\n  blank=https://scholar.google.com/ Google Scholar\n\na|ae|ali|alie|aliexp: https://www.aliexpress.com/wholesale?SearchText=%s \\\n  blank=https://www.aliexpress.com/ AliExpress\nj|jd|jb|joy|joybuy: https://www.joybuy.com/search?keywords=%s \\\n  blank=https://www.joybuy.com/ Joybuy\naz|amazon: https://www.amazon.com/s/?field-keywords=%s \\\n  blank=https://www.amazon.com/ Amazon\n\nv.m|v\\:math: vimium://math\\ $S re= Calculate\ngh|github: https://github.com/search?q=$s \\\n  blank=https://github.com/ GitHub Repo\nge|gitee: https://search.gitee.com/?type=repository&q=$s \\\n  blank=https://gitee.com/ Gitee \u4ed3\u5e93\njs\\:|Js: javascript:\\ $S; JavaScript",showActionIcon:true,showAdvancedCommands:true,showAdvancedOptions:true,showInIncognito:false,notifyUpdate:true,smoothScroll:true,vomnibarOptions:{maxMatches:10,queryInterval:333,sizes:"77,3,44,0.8",styles:"mono-url",actions:""},userDefinedCss:"",vimSync:null,vomnibarPage:"front/vomnibar.html",vomnibarPage_f:"",waitForEnter:true},t.Gt={__proto__:null,extWhiteList:"extAllowList",phraseBlacklist:"omniBlockList"},t.Bt={__proto__:null,searchEngineMap:1,searchEngineRules:1,searchKeywords:1},t.Tt=["showAdvancedCommands"],t.Lt={__proto__:null,filterLinkHints:"f",ignoreCapsLock:"i",ignoreKeyboardLayout:"l",mapModifier:"a",mouseReachable:"e",keyboard:"k",linkHintCharacters:"c",linkHintNumbers:"n",regexFindMode:"r",smoothScroll:"s",scrollStepSize:"t",waitForEnter:"w"},s.Al.runtime.getPlatformInfo(e=>{let a=e.os.toLowerCase(),n=s.Al.runtime.PlatformOs,l=a===n.WIN?2:a===n.MAC?0:1,i=t.Nt("ignoreCapsLock");o.e.cl=a,o.ye.o=o.Ye.o=l,t.Et("i",i,o.Ye),o.je>2||(o.D(1|o.je),gA&&gA.Wt())}),(()=>{let e=s.Al.runtime.getManifest(),{origin:a}=location,n=a+"/",l=e.content_scripts[0].js,i=o.e,r=o.ve,c=e=>(47===e.charCodeAt(0)?a:e.startsWith(n)?"":n)+e;t.Ft.newTabUrl=o.He?"edge://newtab":"chrome://newtab",r.set("about:newtab",1),r.set("about:newtab/",1);{r.set("chrome://newtab",1),r.set("chrome://newtab/",1),o.He&&(r.set("edge://newtab",1),r.set("edge://newtab/",1));let e="chrome://new-tab-page";r.set(e,2),r.set(e+"/",2)}if(o.Te.searchEngineMap=new Map,i.bl=Object.keys(e.commands||{}).map(e=>"quickNext"===e?"nextTab":e),i.rl=e.version,i.pl=e.version_name||e.version,i.ul=c(e.options_page||i.ul),i.ol=null!=e.permissions&&e.permissions.indexOf("clipboardRead")>=0,i.Sl=c(i.Sl),i.Cl=c(t.Ft.vomnibarPage),i.fl=c(i.El),i.gl=e.homepage_url||i.gl,i.wl.release+="#"+i.rl.replace(/\D/g,""),i._l=c(i._l),l.push(i.dl),i.il=l.map(c),!(o.je>2)){o.Ye.g=t.Nt("grabBackFocus");for(let e in t.Lt)t.Et(t.Lt[e],t.Nt(e),o.Ye);for(let e in t.Gt){let o=t.Jt.getItem(e);null!=o&&(t.Rt(t.Gt[e],o),t.Jt.removeItem(e))}}})(),o.je<3&&(o.M(new Promise(e=>{let t=s.Al.runtime.onInstalled,a=o=>{a&&(t.removeListener(a),a=null,e(o))};t.addListener(a),setTimeout(()=>{a&&(t.removeListener(a),a=null,o.M(null))},2500,a)})),o.De.then(e=>{if(!e||"install"!==e.reason||!o.Be)return;let a=(navigator.platform||"").toLowerCase();(a.startsWith("mac")||a.startsWith("ip"))&&t.Rt("ignoreKeyboardLayout",1)}))});