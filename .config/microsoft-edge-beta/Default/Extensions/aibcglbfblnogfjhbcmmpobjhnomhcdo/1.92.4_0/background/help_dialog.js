"use strict";__filename="background/help_dialog.js",define(["require","exports","./store","./utils","./browser","./normalize_urls","./key_mappings"],(e,t,o,a,n,i,r)=>{Object.defineProperty(t,"__esModule",{value:true}),t.mn=t.parseHTML=void 0,a=__importStar(a);let l,s=null,c=null,d=new Map;t.parseHTML=e=>{let t=e.indexOf("</style>")+8,r=e.slice(0,t),s=e.slice(t).trim();s=s.replace(/\$(\w+)/g,(e,t)=>{var o;return null!==(o=l[t])&&void 0!==o?o:t});let c=a.st({homePage:o.e.gl,version:o.e.pl,release:i.yt("vimium://release"),reviewPage:(o.He?"https://microsoftedge.microsoft.com/addons/detail/aibcglbfblnogfjhbcmmpobjhnomhcdo":"https://chrome.google.com/webstore/detail/vimium-c-all-by-keyboard/$id/reviews").replace("$id",()=>n.Al.runtime.id),webStore:l[o.He?"edgestore":"webstore"],browserHelp:o.He?"https://support.microsoft.com/help/4531783/microsoft-edge-keyboard-shortcuts":"https://support.google.com/chrome/answer/157179"});return s=s.replace(/\{\{(\w+)}}/g,(e,t)=>c[t]||e),[r,s]},t.mn=e=>{l=o.Ie[1],s&&!o.Ie[0]||(s=t.parseHTML(o.Ie[0]),o.Ie[0]="");let n=new Map,i=!e,d=e;o.pe.forEach((e,t)=>{if(t.startsWith("<v-")&&t.endsWith(">"))return;let o=b(e.pa),a=n.get(o);a||n.set(o,a=[]),"string"==typeof e.ma&&/\$(?:key|desc)=/.test(e.ma)&&r.oa(e),a.push([t,e])});let g=a.st({title:l[e?"cmdList":"help"]||"",tip:d&&l.tipClickToCopy||"",lbPad:d?'\n\t\t<tr><td class="HelpTd TdBottom">&#160;</td></tr>':""}),m=s[1].replace(/\{\{(\w+)}}/g,(e,t)=>{var o;return null!==(o=g[t])&&void 0!==o?o:p(t,n,i,d)});return c=null,s[0]+m};let includes=(e,t)=>e.includes(t),startsWith=(e,t)=>e.startsWith(t),endsWith=(e,t)=>e.endsWith(t),b=e=>(includes(e,"Mode")&&includes(e,".activate")&&(e=includes(e,"ModeTo")?e.replace("ModeTo",""):e.replace("Mode","")),endsWith(e,"Unhover")?e=e.replace("Unhover","Leave"):endsWith(e,"Goto")?e=e.replace("Goto",""):"clearContentSetting"===e?e=`${e}s`:includes(e,"CS")?e=startsWith(e,"clear")?"clearContentSettings":e.replace("CS","ContentSetting"):includes(e,"vateUrl")?e=e.replace("vateUrl","vateEditUrl"):endsWith(e,"TabSelection")?e=e.replace("TabSelection","Tabs"):"quickNext"===e?e="nextTab":"newTab"===e?e="createTab":"simBackspace"===e?e="simulateBackspace":"showHUD"===e?e="showTip":"wait"===e&&(e="blank"),e),p=(e,t,n,i)=>{let r=l.cmdParams||" (use *)",s=o.Ie[2],c="";for(let o of u[e]){let e=t.get(o);if(n&&!e)continue;let b=1===k[o],p=-2,v="",T=d.get(o);if(!T){let e=s[o];T=l[o].replace("<","&lt;").replace(">","&gt;")+(e?r.replace("*",()=>e):" "),d.set(o,T)}if(e&&e.length>0){v='\n\t\t<span class="HelpKey">';for(let t of e){let e=m(t[1]),n=e&&e.do||a.it(t[0]),r=e&&e.bo;r?c+=g(b,`\n\t\t<span class="HelpKey">${n}</span>\n\t`,i?r+" ":r,i?o:""):(p>=0&&(v+='</span> <span class="HelpKey">'),v+=n,p+=t[0].length+2)}v+="</span>\n\t"}p<=12?c+=g(b,v,T,i?o:""):(c+=g(b,v,"",""),c+=g(b,"",T,i?o:""))}return c},g=(e,t,o,a)=>{let n=e?'<tr class="HelpAdv">\n\t':"<tr>\n\t";return o?(n+='<td class="HelpTd HelpKeys">',n+=t,n+='</td>\n\t<td class="HelpTd HelpCommandInfo">',n+=o,a&&(n+='<span class="HelpCommandName" role="button">(',n+=a,n+=")</span>\n\t")):(n+='<td class="HelpTd HelpKeys HelpLongKeys" colspan="2">',n+=t),n+"</td>\n</tr>\n"},m=e=>{let t=e.ba;if(!t||null!=t.do)return t;if(c);else{let e=document.createElement("template"),t=document.createElement("td");e.content.appendChild(t),c=t}return e.ba={do:t.va?T(t.va):"",bo:t.ka?T(t.ka):""}},v={a:1,abbr:1,acronym:1,address:1,b:1,big:1,blockquote:1,br:1,cite:1,code:1,colgroup:1,dd:1,del:1,dfn:1,div:1,dl:1,dt:1,em:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,i:1,id:1,img:1,ins:1,kbd:1,li:1,ol:1,p:1,pre:1,samp:1,small:1,span:1,strong:1,sub:1,sup:1,table:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,tt:1,u:1,ul:1,var:1,svg:1,path:1,__proto__:null},T=e=>{c.innerHTML=e;for(let e=c.querySelectorAll("*"),t=0,o=e.length;t<o;t++){let o=e[t];if(!(o.localName+""in v||o instanceof HTMLUnknownElement)){o.remove();continue}let a=[];for(let e=o.attributes,t=e.length,n=0;n<t;n++){let t=e[n].name.toLowerCase();/^on|[^\w\-]|href$|^is/i.test(t)&&a.push(e[n])}for(let e of a)o.removeAttributeNode(e)}return c.innerHTML},u={__proto__:null,pageNavigation:["LinkHints.activate","LinkHints.activateOpenInNewTab","LinkHints.activateOpenInNewForegroundTab","LinkHints.activateWithQueue","scrollDown","scrollUp","scrollLeft","scrollRight","scrollToTop","scrollToBottom","scrollToLeft","scrollToRight","scrollPageDown","scrollPageUp","scrollPxDown","scrollPxUp","scrollPxLeft","scrollPxRight","scrollFullPageDown","scrollFullPageUp","scrollSelect","reload","reloadTab","reloadGivenTab","zoom","zoomIn","zoomOut","zoomReset","toggleViewSource","copyCurrentUrl","copyCurrentTitle","switchFocus","focusInput","LinkHints.activateCopyLinkUrl","LinkHints.activateCopyLinkText","openCopiedUrlInCurrentTab","openCopiedUrlInNewTab","goUp","goToRoot","LinkHints.activateDownloadImage","LinkHints.activateOpenImage","LinkHints.activateDownloadLink","LinkHints.activateOpenIncognito","LinkHints.activateHover","LinkHints.activateLeave","LinkHints.unhoverLast","LinkHints.activateSearchLinkText","LinkHints.activateEdit","LinkHints.activateSelect","LinkHints.click","simulateBackspace","dispatchEvent","goPrevious","goNext","nextFrame","mainFrame","parentFrame","enterInsertMode","enterVisualMode","enterVisualLineMode","Marks.activateCreate","Marks.activate","Marks.clearLocal","Marks.clearGlobal","openUrl","focusOrLaunch"],vomnibarCommands:["Vomnibar.activate","Vomnibar.activateInNewTab","Vomnibar.activateBookmarks","Vomnibar.activateBookmarksInNewTab","Vomnibar.activateHistory","Vomnibar.activateHistoryInNewTab","Vomnibar.activateTabs","Vomnibar.activateEditUrl","Vomnibar.activateEditUrlInNewTab","LinkHints.activateOpenVomnibar","toggleVomnibarStyle"],historyNavigation:["goBack","goForward","reopenTab"],findCommands:["enterFindMode","performFind","performBackwardsFind","performAnotherFind","clearFindHistory"],tabManipulation:["nextTab","previousTab","firstTab","lastTab","createTab","duplicateTab","removeTab","removeRightTab","restoreTab","restoreGivenTab","discardTab","moveTabToNextWindow","moveTabToNewWindow","moveTabToIncognito","joinTabs","sortTabs","togglePinTab","toggleMuteTab","visitPreviousTab","closeTabsOnLeft","closeTabsOnRight","closeOtherTabs","moveTabLeft","moveTabRight","enableContentSettingTemp","toggleContentSetting","clearContentSettings","copyWindowInfo","captureTab"],misc:["showHelp","autoCopy","autoOpen","searchAs","searchInAnother","showTip","addBookmark","toggleStyle","toggleLinkHintCharacters","toggleSwitchTemp","passNextKey","debugBackground","reset","runKey","sendToExtension","blank"]},k={__proto__:null,toggleViewSource:1,clearFindHistory:1,dispatchEvent:1,scrollToLeft:1,scrollToRight:1,moveTabToNextWindow:1,moveTabToNewWindow:1,moveTabToIncognito:1,reloadGivenTab:1,focusOrLaunch:1,enableContentSettingTemp:1,toggleContentSetting:1,toggleStyle:1,clearContentSettings:1,"LinkHints.activateDownloadImage":1,reopenTab:1,"LinkHints.activateOpenImage":1,removeRightTab:1,"LinkHints.activateDownloadLink":1,restoreGivenTab:1,runKey:1,sendToExtension:1,discardTab:1,copyWindowInfo:1,"LinkHints.activateOpenIncognito":1,passNextKey:1,goNext:1,goPrevious:1,"Marks.clearLocal":1,"Marks.clearGlobal":1,moveTabLeft:1,moveTabRight:1,closeTabsOnLeft:1,closeTabsOnRight:1,closeOtherTabs:1,scrollPxDown:1,scrollPxUp:1,scrollPxLeft:1,scrollPxRight:1,debugBackground:1,blank:1,reset:1,scrollSelect:1,"LinkHints.activateHover":1,"LinkHints.unhoverLast":1,toggleLinkHintCharacters:1,toggleSwitchTemp:1,"LinkHints.activateLeave":1,"Vomnibar.activateEditUrl":1,"Vomnibar.activateEditUrlInNewTab":1,closeDownloadBar:0,zoomIn:1,zoomOut:1,zoomReset:1};u.misc.push("closeDownloadBar"),o.He&&u.tabManipulation.push("toggleReaderMode")});