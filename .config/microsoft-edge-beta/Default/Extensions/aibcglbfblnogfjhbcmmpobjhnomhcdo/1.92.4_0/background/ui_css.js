"use strict";__filename="background/ui_css.js",define(["require","exports","./store","./utils","./settings","./ports"],(e,n,t,i,r,l)=>{Object.defineProperty(n,"__esModule",{value:true}),n.en=n.nn=void 0;let s=t.e.rl+","+t.Ge+";";n.nn=(e,n)=>{if(-1===e)return S(n,-1);2===e&&t.X(null);{let i;if(i=0===e&&r.Jt.getItem("findCSS"))return t.F(f(i)),t.U(n.slice(s.length)),void(t.ye.c=r.Jt.getItem("omniCSS")||"")}i.a(t.e.baseCSS).then(n=>{s.slice(s.indexOf(",")+1);let t=u(n);{let e=(n=t.ui).indexOf("all:"),i=n.lastIndexOf("{",e),r=n.indexOf(";",e);n=n.slice(0,i+1)+n.slice(e,r+1)+n.slice(n.indexOf("\n",r)+1||n.length)}{let e=n.indexOf("display:"),t=n.lastIndexOf("{",e);n=n.slice(0,t+1)+n.slice(e)}n=n.replace(/\n/g,""),r.Jt.setItem("innerCSS",s+n);let i=t.find;r.Jt.setItem("findCSS",i.length+"\n"+i),S(r.Nt("userDefinedCss"),e)})};let u=e=>{let n=e?e.split(/^\/\*\s?#!?([A-Za-z:]+)\s?\*\//m):[""],t={ui:n[0].trim()};for(let e=1;e<n.length;e+=2){let i=n[e].toLowerCase();t[i]=(t[i]||"")+n[e+1].trim()}return t},f=e=>{let n=(e=e.slice(e.indexOf("\n")+1)).indexOf("\n")+1,t=e.indexOf("\n",n);return{c:e.slice(0,n-1),s:e.slice(n,t).replace("  ","\n"),i:e.slice(t+1)}},S=(e,i)=>{let S=r.Jt.getItem("innerCSS"),o=S.indexOf("\n");S=o>0?S.slice(0,o):S;let d=u(e),C=d.ui?S+"\n"+d.ui:S,a=d["find:host"],c=d.find,m=d.omni,v="findCSS",_="omniCSS";S=r.Jt.getItem(v),o=S.indexOf("\n"),S=S.slice(0,o+1+ +S.slice(0,o));let g=S.indexOf("\n",S.indexOf("\n",o+1)+1),b=S.lastIndexOf("  ",g);if(a=a?"  "+a.replace(/\n/g," "):"",(b>0?S.slice(b,g)!==a:a)&&(S=S.slice(o+1,b>0?b:g)+a+S.slice(g),S=S.length+"\n"+S),c=c?S+"\n"+c:S,S=(r.Jt.getItem(_)||"").split("\n",1)[0],m=m?S+"\n"+m:S,-1===i)return{ui:C.slice(s.length),find:f(c),omni:m};r.Jt.setItem("innerCSS",C),r.Jt.setItem(v,c),m?r.Jt.setItem(_,m):r.Jt.removeItem(_),n.nn(0,C),0!==i&&1!==i&&(l.Kt(e=>{for(let n of e.Qt){let e=n.s.Zt;8&n.s.Zt&&n.postMessage({N:12,H:t.Ne,f:32&e?t.Ae:void 0})}}),r.Ht({N:47,d:{c:t.ye.c}}))};n.en=(e,n)=>{let r,l=t.ye.s;if(!e.o&&t.Me)return;{let n=` ${e.t} `,s=l&&` ${l} `,u=s.includes(n),f=null!=e.e?e.e:u;if(r=f?u?l:l+n:s.replace(n," "),r=r.trim().replace(i.ft," "),false===e.b)return void(t.ye.s=r);e.o&&t.J(f!==` ${t.Te.vomnibarOptions.styles} `.includes(n))}if(r===l)return;t.ye.s=r;let s={N:47,d:{s:r}};i.n(t.fe.slice(0),e=>(e!==n&&t.fe.includes(e)&&e.postMessage(s),1))},r.Ct.userDefinedCss=S,t.U(r.Jt.getItem("innerCSS")||""),t.Ne&&!t.Ne.startsWith(s)?(r.Jt.removeItem("vomnibarPage_f"),n.nn(1,t.Ne)):n.nn(0,t.Ne)});